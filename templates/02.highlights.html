{% extends "00.base.html" %}
{% block title %}Highlights{% endblock %}
{% block content %}
<div class="main-content">
    <h1 class="heading">Highlights</h1>
    <p class="caption">
        Highlights of Taehyung and Jung Kook!
    </p>
    <div class="upcoming-container">
        {% if upcoming %}
            {% for event in upcoming %}
            <div class="upcoming-card">
                <div class="upcoming-header">
                    <h2 class="upcoming-title">{{ event.title }}</h2>
                    <p class="upcoming-date">{{ event.date.strftime('%B %d, %Y') }}</p>
                </div>
    
                <div class="upcoming-body">
                    <!-- Media Slider -->
                    <div class="media-container">
                        <div class="media-slider">
                            {% set media_files = event.image.split(',') %}
                            {% for media in media_files %}
                            <div class="media-slide{% if loop.first %} active{% endif %}">
                                {% if media.strip().endswith('.mp4') %}
                                    <video class="media-video" controls controlsList="nodownload" playsinline webkit-playsinline>
                                        <source src="{{ url_for('static', filename='images/upcoming/dodger/' + media.strip()) }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                {% else %}
                                    <img src="{{ url_for('static', filename='images/upcoming/dodger/' + media.strip()) }}" 
                                         alt="{{ event.title }}">
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        <button class="prev">&#10094;</button>
                        <button class="next">&#10095;</button>
                    </div>
                
                    <div class="upcoming-content">
                        <p class="upcoming-description">
                            {{ event.description.replace('\n', '<br>') | safe }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
        <div class="stay-tuned-banner">
            <p>Taehyung and Jungkook have returned, and the universe is shifting once more.</p>
            <p>While the stage is being set, weâ€™re holding space for whatâ€™s next â€” and itâ€™s going to be unforgettable.ðŸ’œ</p>
            <img src="{{ url_for('static', filename='images/upcoming/stay_tuned.webp') }}" 
                 alt="Stay Tuned" class="stay-tuned-image">
        </div>        
        {% endif %}
        
        {% if recaps %}
        <div class="weekly-recap-section">
            <h2 class="section-heading">ðŸŒŸ Weekly Recap ðŸŒŸ</h2>
            <div class="recap-cards">
                {% for recap in recaps %}
                <div class="recap-card">
                    <h3 class="recap-title">{{ recap.title.replace("Week of ", "Week of<br>") | safe }}</h3>
                    <video class="recap-video" controls controlsList="nodownload">
                        <source src="{{ url_for('static', filename='images/upcoming/' + recap.video) }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- <script>
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.media-container').forEach(container => {
            const slides = container.querySelectorAll('.media-slide');
            const prevBtn = container.querySelector('.prev');
            const nextBtn = container.querySelector('.next');
            let currentIndex = 0;

            function showSlide(index) {
                slides.forEach((slide, i) => slide.classList.toggle('active', i === index));
            }

            showSlide(currentIndex);

            prevBtn.addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                showSlide(currentIndex);
            });

            nextBtn.addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % slides.length;
                showSlide(currentIndex);
            });
        });
    });
</script> -->
    
<script>
    // Auto-scroll for banner carousel
    document.addEventListener("DOMContentLoaded", function () {
        const track = document.querySelector('.banner-track');
        if (track) {
            let scrollAmount = 0;
            let speed = 2; // Speed of scrolling (adjustable)
            function autoScroll() {
                scrollAmount += speed;
                if (scrollAmount >= track.scrollWidth / 2) {
                    scrollAmount = 0;
                }
                track.style.transform = `translateX(-${scrollAmount}px)`;
                requestAnimationFrame(autoScroll);
            }
            autoScroll();
        }
    
        // Event Media Slider Logic
        let sliders = document.querySelectorAll('.media-container');
    
        sliders.forEach((container) => {
            let slides = container.querySelectorAll('.media-slide');
            let prevBtn = container.querySelector('.prev');
            let nextBtn = container.querySelector('.next');
            let currentIndex = 0;
            let totalSlides = slides.length;
    
            function updateSlides() {
                slides.forEach((slide, i) => {
                    slide.style.display = (i === currentIndex) ? "block" : "none";
                });
                prevBtn.style.display = (currentIndex === 0) ? "none" : "block";
                nextBtn.style.display = (currentIndex === totalSlides - 1) ? "none" : "block";
            }
    
            function moveSlide(step) {
                currentIndex += step;
                updateSlides();
            }
    
            prevBtn.addEventListener("click", () => moveSlide(-1));
            nextBtn.addEventListener("click", () => moveSlide(1));
    
            updateSlides();
        });
    });
    
    // Open image in full-screen
    function openFullScreen(img) {
        const imageUrl = img.src;
        const newWindow = window.open("", "_blank");
        newWindow.document.write(`<img src="${imageUrl}" style="width:100%; height:auto;">`);
    }
</script>
        
{% endblock %}
