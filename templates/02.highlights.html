{% extends "00.base.html" %}
{% block title %}Highlights{% endblock %}
{% block content %}
<div class="main-content">
    <h1 class="heading">Highlights</h1>
    <p class="caption">
        Highlights of Taehyung and Jung Kook!
    </p>
    <div class="upcoming-container">
        {% if upcoming %}
            {% for event in upcoming %}
            <div class="upcoming-card">
                <div class="upcoming-header">
                    <h2 class="upcoming-title">{{ event.title }}</h2>
                    <p class="upcoming-date">{{ event.date.strftime('%B %d, %Y') }}</p>
                </div>
    
                <div class="upcoming-body">
                    <!-- Media Slider -->
                    <div class="media-container">
                        <div class="media-slider">
                            {% set media_files = event.image.split(',') %}
                            {% for media in media_files %}
                            <div class="media-slide" style="display:block;">
                                {% if media.strip().endswith('.mp4') %}
                                    <video class="media-video" controls controlsList="nodownload" playsinline webkit-playsinline>
                                        <source src="{{ url_for('static', filename='images/upcoming/dodger/' + media.strip()) }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                {% else %}
                                    <img src="{{ url_for('static', filename='images/upcoming/dodger/' + media.strip()) }}" alt="{{ event.title }}">
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        <button class="prev">&#10094;</button>
                        <button class="next">&#10095;</button>
                    </div>
                
                    <div class="upcoming-content">
                        <p class="upcoming-description">
                            {{ event.description.replace('\n', '<br>') | safe }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
        <div class="stay-tuned-banner">
            <p>Taehyung and Jungkook have returned, and the universe is shifting once more.</p>
            <p>While the stage is being set, weâ€™re holding space for whatâ€™s next â€” and itâ€™s going to be unforgettable.ðŸ’œ</p>
            <img src="{{ url_for('static', filename='images/upcoming/stay_tuned.webp') }}" 
                 alt="Stay Tuned" class="stay-tuned-image">
        </div>        
        {% endif %}
        
        {% if recaps %}
        <div class="weekly-recap-section">
            <h2 class="section-heading">ðŸŒŸ Weekly Recap ðŸŒŸ</h2>
            <div class="recap-cards">
                {% for recap in recaps %}
                <div class="recap-card">
                    <h3 class="recap-title">{{ recap.title.replace("Week of ", "Week of<br>") | safe }}</h3>
                    <video class="recap-video" controls controlsList="nodownload">
                        <source src="{{ url_for('static', filename='images/upcoming/' + recap.video) }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Event Media Slider Logic
        const sliders = document.querySelectorAll('.media-container');
    
        sliders.forEach((container) => {
            const slides = container.querySelectorAll('.media-slide');
            const prevBtn = container.querySelector('.prev');
            const nextBtn = container.querySelector('.next');
            let currentIndex = 0;
            const totalSlides = slides.length;
    
            // If only 1 slide, hide buttons
            if (totalSlides <= 1) {
                prevBtn.style.display = "none";
                nextBtn.style.display = "none";
            }
    
            function showSlide(index) {
                slides.forEach((slide, i) => {
                    slide.style.display = (i === index) ? "block" : "none";
                });
            }
    
            showSlide(currentIndex);
    
            prevBtn.addEventListener("click", () => {
                currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
                showSlide(currentIndex);
            });
    
            nextBtn.addEventListener("click", () => {
                currentIndex = (currentIndex + 1) % totalSlides;
                showSlide(currentIndex);
            });
        });
    });
    </script>
    
        
{% endblock %}
