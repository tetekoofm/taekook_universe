{% extends "00.base.html" %}
{% block title %}TaeKook Universe{% endblock %}
{% block content %}

<div class="main-content">
  <h1 class="heading">Welcome to TaeKook Universe!</h1>
  <p class="caption">A fanpage dedicated to Kim Taehyung and Jeon Jung Kook.</p>
  <p class="caption">Follow their incredible journey from their debut till now!</p>

  <!-- Image Carousel -->
  <div class="image-carousel">
    <div class="slides-track">
      {% for media in images %}
        <div class="image-slide">
          {% if media.endswith('.mp4') %}
            <video class="glow-media" autoplay loop muted playsinline>
              <source src="{{ url_for('static', filename='images/home/pictureoftheday/' + media) }}" type="video/mp4">
            </video>
          {% else %}
            <img class="glow-media" src="{{ url_for('static', filename='images/home/pictureoftheday/' + media) }}" alt="Taekook {{ loop.index }}">
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>

  <script>
    const track = document.querySelector('.slides-track');
    const slides = document.querySelectorAll('.image-slide');
    const totalSlides = slides.length;
    let index = 0;

    function getVisibleSlides() {
        if (window.innerWidth <= 768) return 1;       // mobile
        else if (window.innerWidth <= 1024) return 2;  // tablet
        else return 3;                                 // desktop
    }

    // Clone first few slides for seamless looping
    const visibleSlides = getVisibleSlides();
    for (let i = 0; i < visibleSlides; i++) {
        const clone = slides[i].cloneNode(true);
        track.appendChild(clone);
    }

    function slideCarousel() {
        const visible = getVisibleSlides();
        index++;
        track.style.transition = 'transform 1s ease-in-out';
        const offset = -(index * (100 / visible));
        track.style.transform = `translateX(${offset}%)`;

        // Loop back seamlessly
        if (index >= totalSlides) {
            setTimeout(() => {
                track.style.transition = 'none';
                index = 0;
                track.style.transform = `translateX(0%)`;
            }, 1000); // match transition duration
        }
    }

    setInterval(slideCarousel, 4000);

    // Reset on resize
    window.addEventListener('resize', () => {
        index = 0;
        track.style.transition = 'none';
        track.style.transform = 'translateX(0%)';
    });
    
    // Background stars
    function generateStars() {
        const nightSky = document.createElement('div');
        nightSky.classList.add('night-sky');
        document.body.appendChild(nightSky);
    
        const numberOfStars = 300;
        for (let i = 0; i < numberOfStars; i++) {
            const star = document.createElement('div');
            star.classList.add('star');
            star.style.top = `${Math.random() * 100}vh`;
            star.style.left = `${Math.random() * 100}vw`;
            star.style.animationDuration = `${Math.random() * 3 + 2}s`;
            nightSky.appendChild(star);
        }
    }
    
    window.onload = generateStars;
    </script>  
    
{% endblock %}
